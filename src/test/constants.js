const SCHEME_TYPES = {
  // none: 'none',
  BFV: 'BFV',
  CKKS: 'CKKS',
}
const SECURITY_LEVELS = {
  // none: 0,
  BITS_128: 128,
  BITS_192: 192,
  BITS_256: 256,
}
const POLYMODULUS_DEGREES = {
  // BITS_1024: 1024,
  // BITS_2048: 2048,
  BITS_4096: 4096,
  BITS_8192: 8192,
  BITS_16384: 16384,
  BITS_32768: 32768,
}

// From BFVDefault()
const BFV_COEFF_MOD_BIT_SIZES = {
  [SECURITY_LEVELS.BITS_128]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [27],
    [POLYMODULUS_DEGREES.BITS_2048]: [54],
    [POLYMODULUS_DEGREES.BITS_4096]: [36, 36, 37],
    [POLYMODULUS_DEGREES.BITS_8192]: [43, 43, 44, 44, 44],
    [POLYMODULUS_DEGREES.BITS_16384]: [48, 48, 48, 49, 49, 49, 49, 49, 49],
    [POLYMODULUS_DEGREES.BITS_32768]: [55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 56]
  },
  [SECURITY_LEVELS.BITS_192]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [19],
    [POLYMODULUS_DEGREES.BITS_2048]: [37],
    [POLYMODULUS_DEGREES.BITS_4096]: [25, 25, 25],
    [POLYMODULUS_DEGREES.BITS_8192]: [38, 38, 38, 38],
    [POLYMODULUS_DEGREES.BITS_16384]: [50, 50, 50, 50, 50, 50],
    [POLYMODULUS_DEGREES.BITS_32768]: [54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55]
  },
  [SECURITY_LEVELS.BITS_256]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [14],
    [POLYMODULUS_DEGREES.BITS_2048]: [29],
    [POLYMODULUS_DEGREES.BITS_4096]: [58],
    [POLYMODULUS_DEGREES.BITS_8192]: [39, 39, 40],
    [POLYMODULUS_DEGREES.BITS_16384]: [47, 47, 47, 48, 48],
    [POLYMODULUS_DEGREES.BITS_32768]: [52, 53, 53, 53, 53, 53, 53, 53, 53]
  }
}

const CKKS_COEFF_MOD_BIT_SIZES = {
  [SECURITY_LEVELS.BITS_128]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [27],
    [POLYMODULUS_DEGREES.BITS_2048]: [54],
    [POLYMODULUS_DEGREES.BITS_4096]: [46, 16, 46],
    [POLYMODULUS_DEGREES.BITS_8192]: [60, 20, 20, 20, 20, 60],
    [POLYMODULUS_DEGREES.BITS_16384]: [60, 39, 39, 39, 39, 39, 39, 39, 39, 60],
    [POLYMODULUS_DEGREES.BITS_32768]: [55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 56]
  },
  [SECURITY_LEVELS.BITS_192]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [19],
    [POLYMODULUS_DEGREES.BITS_2048]: [37],
    [POLYMODULUS_DEGREES.BITS_4096]: [29, 16, 29],
    [POLYMODULUS_DEGREES.BITS_8192]: [56, 20, 20, 56],
    [POLYMODULUS_DEGREES.BITS_16384]: [60, 39, 39, 39, 39, 60],
    [POLYMODULUS_DEGREES.BITS_32768]: [54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55]
  },
  [SECURITY_LEVELS.BITS_256]: {
    [POLYMODULUS_DEGREES.BITS_1024]: [14],
    [POLYMODULUS_DEGREES.BITS_2048]: [29],
    [POLYMODULUS_DEGREES.BITS_4096]: [58],
    [POLYMODULUS_DEGREES.BITS_8192]: [39, 20, 20, 39],
    [POLYMODULUS_DEGREES.BITS_16384]: [60, 39, 39, 39, 60],
    [POLYMODULUS_DEGREES.BITS_32768]: [52, 53, 53, 53, 53, 53, 53, 53, 53]
  }
}

const ARRAY_SIZES = {
  [SCHEME_TYPES.BFV]: {
    [POLYMODULUS_DEGREES.BITS_1024]: 1024,
    [POLYMODULUS_DEGREES.BITS_2048]: 2048,
    [POLYMODULUS_DEGREES.BITS_4096]: 4096,
    [POLYMODULUS_DEGREES.BITS_8192]: 8192,
    [POLYMODULUS_DEGREES.BITS_16384]: 16384,
    [POLYMODULUS_DEGREES.BITS_32768]: 32768,
  },
  [SCHEME_TYPES.CKKS]: {
    [POLYMODULUS_DEGREES.BITS_1024]: 512,
    [POLYMODULUS_DEGREES.BITS_2048]: 1024,
    [POLYMODULUS_DEGREES.BITS_4096]: 2048,
    [POLYMODULUS_DEGREES.BITS_8192]: 4096,
    [POLYMODULUS_DEGREES.BITS_16384]: 8192,
    [POLYMODULUS_DEGREES.BITS_32768]: 16384,
  }
}

const SCHEME_TYPES_CONSTRUCTOR = {
  [SCHEME_TYPES.none]: 'Morfix.SchemeType.none',
  [SCHEME_TYPES.BFV]: 'Morfix.SchemeType.BFV',
  [SCHEME_TYPES.CKKS]: 'Morfix.SchemeType.CKKS',
}

const SECURITY_LEVELS_CONSTRUCTOR = {
  [SECURITY_LEVELS.none]: 'Morfix.SecurityLevel.none',
  [SECURITY_LEVELS.BITS_128]: 'Morfix.SecurityLevel.tc128',
  [SECURITY_LEVELS.BITS_192]: 'Morfix.SecurityLevel.tc192',
  [SECURITY_LEVELS.BITS_256]: 'Morfix.SecurityLevel.tc256',
}

const ENCODERS_CONSTRUCTOR = {
  [SCHEME_TYPES.BFV]: 'Morfix.BatchEncoder',
  [SCHEME_TYPES.CKKS]: 'Morfix.CKKSEncoder',
}

const TYPES = {
  INT32: 'int32',
  UINT32: 'uint32',
  FLOAT: 'float64'
}
const TYPES_CONSTRUCTOR = {
  [SCHEME_TYPES.BFV]: {
    [TYPES.INT32]: 'Int32Array',
    [TYPES.UINT32]: 'Uint32Array'
  },
  [SCHEME_TYPES.CKKS]: {
    [TYPES.FLOAT]: 'Float64Array',
  }
}

const ENCODE_ACTIONS_CONSTRUCTOR = {
  [SCHEME_TYPES.BFV]: {
    [TYPES.INT32]: 'encode',
    [TYPES.UINT32]: 'encode'
  },
  [SCHEME_TYPES.CKKS]: {
    [TYPES.FLOAT]: 'encode'
  }
}

const DECODE_ACTIONS_CONSTRUCTOR = {
  [SCHEME_TYPES.BFV]: {
    [TYPES.INT32]: 'decode',
    [TYPES.UINT32]: 'decode'
  },
  [SCHEME_TYPES.CKKS]: {
    [TYPES.FLOAT]: 'decode'
  }
}

module.exports = {
  SCHEME_TYPES,
  SECURITY_LEVELS,
  POLYMODULUS_DEGREES,
  BFV_COEFF_MOD_BIT_SIZES,
  CKKS_COEFF_MOD_BIT_SIZES,
  ARRAY_SIZES,
  SCHEME_TYPES_CONSTRUCTOR,
  SECURITY_LEVELS_CONSTRUCTOR,
  ENCODERS_CONSTRUCTOR,
  TYPES,
  TYPES_CONSTRUCTOR,
  ENCODE_ACTIONS_CONSTRUCTOR,
  DECODE_ACTIONS_CONSTRUCTOR
}
